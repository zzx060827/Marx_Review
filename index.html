<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>马克思主义基本原理 - 智能背诵复习</title>
    <style>
        /* --- 基础变量 --- */
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --noun-color: #8e44ad;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --error-color: #c0392b;
            --bg-color: #f5f6fa;
            --card-bg: #ffffff;
            --text-gray: #6b7280;
        }

        body {
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
            background-color: var(--bg-color);
            color: var(--primary-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            padding: 30px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            height: 90vh; /* 固定高度 */
            position: relative;
        }

        /* --- 顶部个人品牌 --- */
        .branding-section {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
        }
        
        .branding-link {
            display: flex;
            align-items: center;
            text-decoration: none;
            cursor: pointer;
        }

        .branding-text {
            font-size: 14px;
            color: var(--text-gray);
            margin-right: 12px;
            transition: color 0.3s;
        }

        .branding-link:hover .branding-text {
            color: var(--accent-color);
        }

        .branding-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .branding-link:hover .branding-avatar {
            border-color: var(--accent-color);
            transform: scale(1.05);
        }

        /* --- 标题与统计 --- */
        h1 {
            text-align: center;
            color: var(--primary-color);
            margin: 10px 0 20px 0;
            font-size: 24px;
            flex-shrink: 0;
            padding-right: 100px;
        }

        .stats-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            flex-shrink: 0;
            border: 1px solid #eee;
        }

        /* --- 控制面板与导航 --- */
        .controls-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
            flex-shrink: 0;
        }

        .mode-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .nav-group {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        button {
            padding: 8px 14px;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            background-color: #fff;
            color: #4b5563;
        }

        button.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        button.active.noun-mode-btn {
            background-color: var(--noun-color);
            border-color: var(--noun-color);
        }

        button:hover:not(.disabled) {
            background-color: #f3f4f6;
            transform: translateY(-1px);
        }
        
        button.active:hover { opacity: 0.9; }

        .jump-input {
            width: 50px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }

        /* --- 答题区域 --- */
        .question-card {
            background: #fff;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 25px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .question-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #111827;
            line-height: 1.6;
        }

        .hint-text {
            font-size: 15px;
            color: #d35400;
            background-color: #fef5e7;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            border-left: 4px solid var(--warning-color);
            display: none;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        textarea {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            resize: vertical;
            font-size: 16px;
            font-family: inherit;
            box-sizing: border-box;
            margin-bottom: 20px;
            transition: border-color 0.2s;
        }

        textarea:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1); }

        .action-area {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-top: auto;
        }

        .btn-submit { background-color: var(--success-color); color: white; border: none; flex: 2; }
        .btn-submit:hover { background-color: #219150; }
        
        .btn-hint { background-color: #fff; color: var(--warning-color); border-color: var(--warning-color); }
        .btn-hint:hover { background-color: var(--warning-color); color: white; }

        .btn-prev { flex: 1; }
        .btn-next { flex: 1; border-color: var(--accent-color); color: var(--accent-color); }
        .btn-next:hover { background-color: var(--accent-color); color: white; }

        /* --- 结果展示 --- */
        .result-area {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: #f9fafb;
            display: none;
            border: 1px solid #eee;
        }

        .result-header { font-weight: bold; font-size: 16px; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .score-badge { padding: 4px 8px; border-radius: 4px; font-size: 12px; color: white; }
        .badge-pass { background-color: var(--success-color); }
        .badge-fail { background-color: var(--error-color); }

        .standard-answer {
            color: #374151;
            background: #eefdf5;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid var(--success-color);
            line-height: 1.6;
            white-space: pre-wrap;
            font-size: 15px;
        }

        /* --- 知识点列表模式 --- */
        .list-view-area {
            display: none;
            flex-grow: 1;
            overflow-y: auto;
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 15px;
        }

        .list-item {
            padding: 20px;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            transition: background 0.2s;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .list-item:hover { background-color: #f9fafb; }
        .list-item.active-item { background-color: #eef2ff; border-left: 4px solid var(--accent-color); }

        .list-q { font-weight: 700; color: var(--primary-color); margin-bottom: 10px; font-size: 16px; }
        .list-a { color: #374151; font-size: 15px; line-height: 1.6; white-space: pre-wrap; }

        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #9ca3af; }

    </style>
</head>
<body>

<div class="container">
    <div class="branding-section">
        <a href="https://github.com/zzx060827" target="_blank" rel="noopener noreferrer" class="branding-link">
            <span class="branding-text">Presented by zzx</span>
            <img src="https://i.postimg.cc/44VBbR31/20250611113901.jpg" class="branding-avatar" alt="User Avatar" onerror="this.style.display='none'">
        </a>
    </div>

    <h1>马克思主义基本原理（2023版）</h1>
    
    <div class="stats-bar">
        <span id="data-source-text">当前题库: 简答题</span>
        <span id="progress-text">进度: 1 / 100</span>
        <span id="score-text">准确率: --</span>
        <span id="error-count" style="color: var(--error-color);">错题本: 0</span>
    </div>

    <div class="controls-row">
        <div class="mode-group">
            <button id="mode-seq" class="active" onclick="switchMode('seq')">顺序模式</button>
            <button id="mode-rand" onclick="switchMode('rand')">随机模式</button>
            <button id="mode-err" onclick="switchMode('err')">错题本</button>
            <button id="mode-noun" class="noun-mode-btn" onclick="switchMode('noun')">📚 名词解释</button>
            <button id="mode-list" onclick="switchMode('list')">📖 知识点一览</button>
        </div>
        
        <div class="nav-group" id="nav-controls">
            <span>跳转至:</span>
            <input type="number" id="jump-index" class="jump-input" min="1" onkeypress="handleJumpEnter(event)">
            <button onclick="jumpToQuestion()">Go</button>
        </div>
    </div>

    <div id="quiz-area" class="question-card">
        <div id="question-text" class="question-title">加载中...</div>
        
        <div id="hint-display" class="hint-text"></div>

        <textarea id="user-input" placeholder="请在此输入你的答案...（支持模糊匹配，不计标点符号）"></textarea>
        
        <div class="action-area">
            <button class="btn-prev" onclick="changeQuestion(-1)">上一题</button>
            <button class="btn-hint" onclick="toggleHint()">💡 查看提示</button>
            <button class="btn-submit" id="btn-submit" onclick="checkAnswer()">提交验证</button>
            <button class="btn-next" id="btn-next" onclick="changeQuestion(1)">下一题</button>
        </div>

        <div id="result-area" class="result-area">
            <div id="result-header" class="result-header"></div>
            <div class="answer-comparison">
                <div id="standard-answer" class="standard-answer"></div>
            </div>
        </div>
    </div>

    <div id="list-view" class="list-view-area"></div>
</div>

<script>
    // ==========================================
    // 数据源 1: 原有简答题库 (Principle)
    // ==========================================
    const principleData = [
        // 导论
        { h: "总括，哲学角度，政经科社角度，目的作用", q: "什么是马克思主义？（总括、哲学、政经科社、目的作用）", a: "1. 总括：马克思主义是由马克思和恩格斯创立并为后继者所不断发展的科学理论体系。\n2. 哲学角度：是关于自然、社会和人类思维发展一般规律的学说。\n3. 政治经济学和科学社会主义角度：是关于社会主义必然代替资本主义、最终实现共产主义的学说。\n4. 最终目的和重要作用：是关于无产阶级解放、全人类解放和每个人自由而全面发展的学说，是指引人民创造美好生活的行动指南。是无产阶级额政党和社会主义国家的指导思想" },
        { h: "基本立场，基本观点，基本方法", q: "马克思主义的基本立场、基本观点和基本方法是什么？", a: "1. 基本立场：观察、分析和解决问题的根本立足点和出发点。以无产阶级的解放和全人类的解放为己任，以人的自由全面发展为美好目标；以人民为中心。\n2. 基本观点：关于自然、社会和人类思维发展一般规律的科学认识，是对人类思想成果和社会实践经验的科学总结。\n3. 基本方法：建立在辩证唯物主义和历史唯物主义世界观和方法论基础上，指导我们正确认识世界和改造世界的思想方法和工作方法。" },
        { h: "标志，社会根源，阶级基础，思想渊源", q: "马克思主义是如何产生的", a: "1848年共产党宣言的发表标志着马克思主义的公开问世，其产生的社会根源、阶级基础和思想渊源如下：\n1. 社会根源：工业革命后资本主义生产方式的发展，及其带来的社会灾难（两极分化、经济危机）。\n2. 阶级基础：无产阶级反对资产阶级的斗争标志着无产阶级登上历史舞台。\n3. 思想渊源：直接理论来源是德国古典哲学、英国古典政治经济学、英法空想社会主义。自然科学前提是能量守恒定律、细胞学说、生物进化论。更广泛意义上包括古希腊罗马哲学，文艺复兴运动的思想成果，法国复辟时期历史学家的进步思想" },
        { h: "四个特性，一句话概括（革命性与科学性关系）", q: "马克思主义的基本特征是什么？", a: "鲜明的科学性、人民性、实践性和发展性。\n1. 科学性：正确反映自然，社会与人类思想发展的本质与规律，逻辑严密，具有科学探索性。\n2. 人民性：是本质属性，人民至上，以阶级性为基础。\n3. 实践性：实践观点是首要的和基本的观点。从实践中来，到实践中去。\n4. 发展性：与时俱进，开放的学说。\n一句话概括：科学性与革命性的统一。革命性是马克思主义的内在本质，是其人民性，实践性和发展性的必然要求\n革命性是建立在科学性基础之上的，是与科学性高度统一的。" },
        // 第一章
        { h: "内容，第一方面（本原），第二方面（同一性）", q: "哲学的基本问题及其内容？", a: "存在和思维、物质和精神的关系问题。\n1. 存在和思维，物质和精神何者为本原（第一性）：划分唯物主义和唯心主义的标准。\n2. 存在和思维，物质和精神是否具有同一性：思维能否正确的反映存在，人能否认识或彻底认识世界的问题，划分可知论和不可知论的标准。" },
        { h: "概念（唯一特性），四个理论意义", q: "马克思主义物质观（物质的定义及理论意义）", a: "1. 概念：物质是标志客观实在的哲学范畴，是不依赖于人的意识而存在，并能为人的意识所反映的客观实在。物质具有客观实在性。\n2. 意义：坚持唯物主义一元论同唯心主义划清了界限；坚持能动的反映论和可知论；体现唯物论和辩证法的统一；体现自然观与历史观的统一。" },
        { h: "运动的概念，物质和运动关系，绝对运动与相对静止", q: "物质的存在方式和根本属性是运动", a: "1. 运动的概念是标志一切事物和现象的变化及其过程的哲学范畴。\n2. 物质和运动不可分割：运动是物质的运动，物质是运动着的物质。\n3. 绝对运动与相对静止对立统一：运动是绝对的（变动性、无条件性）；静止是相对的，包括空间位置的暂时不变和事物根本性质暂时不变（体现运动的稳定性、有条件性）；二者相互依赖，对立统一。" },
        { h: "时间，空间，客观性，方法论", q: "物质运动的基本存在形式：时间和空间的概念及特性？", a: "1. 时间：物质运动的持续性、顺序性，特点是一维性。\n2. 空间：物质运动的广延性、伸张性，特点是三维性。\n3. 客观性：物质运动与时空不可分割。\n4. 方法论：想问题，做事一切以时间、地点、条件为转移。" },
        { h: "物质决定意识，意识能动作用，方法论", q: "物质和意识的辩证关系原理？", a: "1. 物质决定意识（从意识的本质和起源思考）：意识是自然界和人类社会历史长期发展的产物，是人脑的机能和属性，是客观世界的主观映像。意识的内容是客观的，形式上是主观的，是客观内容和主观形式的统一。\n2. 意识对物质具有反作用（能动作用）：意识具有目的性、计划性、创造性；指导实践改造客观世界；调控人的行为和生理活动。\n3. 方法论：正确把握物质与意识的辩证关系，要求我们坚持一切从实际出发，实事求是，处理好主观能动性和客观规律性的关系" },
        { h: "实质，四个区别", q: "人工智能与人类意识的区别？", a: "1. 人工智能实质是对人脑组织结构与思维运行机制的模仿，是人类意识的物化。\n2. 区别：人类意识是知情意统一体，AI只是模拟理性智能；人类意识有社会性，AI无；人类语言是思维外壳，AI难以完全理解自然语言；人脑有无法被化约为数字信号的内容。" },
        { h: "自然界，人类社会，意识，结论，方法论", q: "世界的物质统一性原理？", a: "世界的统一性在于它的物质性。\n1. 自然界是物质的，人类实践无法改变客观实在性\n2. 人类社会本质上是生产实践基础上形成的物质体系（自然基础是物质的、获取生活资料的活动是物质性的、物质资料的生产方式构成了人类社会的基础，体现社会的物质性）。\n3. 意识统一于物质。\n4. 世界的物质统一性是多样性的统一。\n5. 方法论：一切从实际出发，实事求是。" },
        { h: "含义，三个特征（客观、自觉、社会）", q: "实践的含义及基本特征？", a: "1. 含义：人类能动地改造世界的社会性的物质活动。\n2. 特征：客观实在性（诸要素是客观的，受规律支配，可以把脑中观念变现实）；自觉能动性（有目的有意识）；社会历史性（主体的人处在社会关系中，实践受历史条件制约）。" },
        { h: "主体，客体，中介，关系，演变，类型", q: "实践的基本结构（主体、客体、中介）", a: "1. 实践主体：具有能力、从事社会实践的人。\n2. 实践客体：实践活动指向的对象。\n3. 实践中介：各种工具、手段及运用操作的程序、方法。\n4. 关系：主体与客体的实践关系（最根本）、认识关系、价值关系。\n5. 演变：主体客体化和客体主体化的双向运动。实践的基本类型包括物质生产实践，社会政治实践，科学文化实践" },
        { h: "辩证统一关系，前提，要求", q: "主观能动性与客观规律性的辩证统一？", a: "1. 尊重客观规律和发挥主观能动性辩证统一。实践是客观规律性和主观能动性统一的基础\n2.尊重客观规律是发挥主观能动性的前提，只有充分发挥主观能动性，才能更好的认识和利用客观规律\n3. 正确发挥主观能动性的前提：从实际出发；以实践为途径；依赖物质条件与手段。\n4. 要求：坚持遵循客观规律和发挥主观能动性相统一，充分发扬历史主动精神。" },
        { h: "含义，四个特点（客观、普遍、多样、条件）", q: "唯物辩证法的总观点：联系观", a: "1. 联系：事物之间和内部要素间相互影响、制约、作用。\n2. 特点：客观性（固有）；普遍性（事务内部要素联系、同其他事物联系、世界是统一整体）；多样性：不同的联系构成事务内部和事物之间的状态和发展趋势；条件性（支持或制约，条件可以改变，但需尊重规律）。" },
        { h: "含义与实质，新旧事物，新事物不可战胜的原因", q: "唯物辩证法的总观点：发展观（实质与新事物）", a: "1. 含义与实质：发展是在事物变化中前进的，上升的运动。是新事物的产生和旧事物的灭亡。\n2. 新事物是指合乎历史发展方向/具有远大前途的东西，旧事物指的是丧失历史必然性，日趋灭亡的东西。新事物不可战胜的原因：新事物有新的要素，功能，更适应新环境；脱胎于旧事物，自然否定消极腐朽、继承合理因素；符合人民群众利益。" },
        { h: "关系，相互渗透，方法论", q: "量变质变规律", a: "1. 量变是质变的必要准备。\n2. 质变是量变的必然结果，\n3. 相互渗透\n4. 方法论：注重积累，抓住机遇。" },
        { h: "定义，实质，揭示内容", q: "否定之否定规律", a: "1. 否定是事物的自我否定，是发展的环节，是联系的环节。\n2. 实质是“扬弃”（批判继承）。\n3. 揭示了事物发展的前进性与曲折性的统一。" },
        { h: "地位，作用，方法论（矛盾分析法）", q: "对立统一规律", a: "对立统一规律是唯物辩证法的实质与核心。\n它揭示了事物普遍联系的根本内容和变化发展的内在动力，根本上回答了事物为什么会发展\n它是贯穿量变质变规律，否定之否定规律，唯物主义辩证法的中心思想，是理解这些规律的钥匙\n对立统一规律提供了人们认识世界和改造世界的根本方法——矛盾分析法。矛盾分析法在唯物主义辩证法的方法论体系中处于核心地位，核心要求是善于分析矛盾的特殊性，做到具体问题具体分析" },
        { h: "基本属性，关系，作用，方法论", q: "矛盾同一性与斗争性", a: "矛盾的基本属性是对立性和同一性。1. 同一性：矛盾相互依存、相互贯通（转化）。\n2. 斗争性：矛盾的对立面相互排斥、相互分离。\n3. 关系：斗争性和同一性相辅相成。斗争性寓于同一性之中；同一性相对，斗争性绝对。\n4. 作用：斗争性和同一性结合构成矛盾运动推动发展。 \n方法论：观察处理问题的时候必须善于把他们结合" },
        { h: "普遍性，特殊性，关系", q: "矛盾的普遍性和特殊性及其关系", a: "1. 普遍性：矛盾存在于一切事物中，贯穿始终（共性）。\n2. 特殊性：不同矛盾/不同阶段各有特点，决定事物性质（个性）。\n3. 关系：普遍性与特殊性辩证统一，共性绝对，个性相对，共性寓于个性之中。" },
        { h: "主要矛盾，两点论，重点论", q: "主要矛盾和次要矛盾，矛盾的主要方面和次要方面的辩证统一关系", a: "主要矛盾是处于支配地位，起主导作用的。两点论：分析矛盾时即看到对立又看到统一，既主要又次要。重点论：善于把握主要矛盾作为出发点" },
        { h: "客观辩证法，主观辩证法，关系", q: "主观辩证法与客观辩证法", a: "唯物辩证法是二者统一\n1. 客观辩证法：客观事物以相互作用和联系的形式呈现的辩证运动和发展规律。\n2. 主观辩证法：人类认识和思维的辩证运动与发展规律。\n3. 关系：本质统一，表现形式不同。客观辩证法采取外部必然性，不以人的意志转移，主观辩证法是概念为基础的辩证思维规律" },
        // 第二章
        { h: "来源，动力，目的，唯一标准", q: "实践在认识活动中的决定作用（实践是认识的基础）", a: "1. 实践是认识的来源。认识的内容在实践过程中产生，人们只有通过实践实地改造对象才能更清楚物质的本质属性规律，产生正确认识并指导人类活动。\n2. 实践是认识发展的动力（实践的需要推动认识的发展、实践为认识的发展提供手段和条件、实践改造了主观世界，锻炼了能力）。\n3. 实践获得认识的最终目的是为实践服务满足需要。\n4. 实践是检验认识真理性的唯一标准。\在实践检验真理的时候逻辑证明可以起到补充作用" },
        { h: "本质，两个特点（反映性、创造性）", q: "认识的本质", a: "主体在实践基础上对客体的能动反映。\n特点：具有反应客体内容的反应性特征和实践要求的主体能动的，创造性的特征" },
        { h: "第一次飞跃（感性到理性），第二次飞跃（认识到实践），总规律", q: "认识运动的基本规律（两次飞跃）", a: "1. 实践基础上从实践到认识（感性到理性）：感性认识（直接性、具体性）是实践基础上感觉器官感知的认识。包括感觉、知觉、表象；理性认识（抽象、间接）借助抽象思维，包括概念、判断、推理。条件：丰富感性材料+科学抽象思考。感性认识和理性认识辩证统一\n2. 从认识到实践：1.必要性：认识世界指导改造世界，检验真理只有实践。2.中介环节：确定目的、方案、中间实验、宣传群众。\n3. 总规律：反复循环，无限发展，波浪式前进，螺旋式上升。" },
        { h: "完成与未完成，发展规律（多重反复），无限发展，方法论", q: "实践与认识的辩证运动及其规律", a: "经历从实践到认识，再从认识到实践后，实践与认识到运动完成了又没完成。1.完成了针对具体事物的认识，没完成针对实践和认识向前发展\n2.辩证运动的发展规律就是正确的认识需要经历从实践到认识再到实践的多重反复\n3.认识是一个无限发展的过程，这其中既有认识在实践基础上不断深化，也有实践在认识指导下向合理方向推进。\n方法论：实践和认识的辩证运动中必须主管统一于客观，认识统一于实践，坚持主客观统一" },
        { h: "客观性，绝对性，相对性，二者关系", q: "*真理的客观性、绝对性与相对性", a: "1. 客观性：真理标志着主客观相符合的哲学范畴，真理的本质属性是客观性。客观性决定一元性（同条件下对一认识客体的真理只有一个），本质上是客观的，形式上是主观的，是内容上一元性和形式多样性的统一。\n方法论上：要求我们老实科学态度，尊重真理。\n2. 绝对性：任何真理都是绝对相对统一，真理有主客观统一的确定性和发展的无限性\n3. 真理的相对性：人在一定条件下对事物的本质和发展规律的认识的广度和深度是有限度的。\n4. 真理相对性和绝对性的关系：相互依存，相互包含，永远发展。绝对性和相对性源于人认识世界的能力的矛盾。反对绝对主义和相对主义。" },
        { h: "定义，关系，转化", q: "真理与谬误", a: "1. 真理是主客观相符合，是对客观事物，规律的正确反应，谬误相反。\n2. 关系：既对立又统一。\n3. 转化：真理在一定范围、条件下是真理，超出则变谬误；修正错误可转化为真理；批判谬误发展真理。方法论：真理与谬误斗争而发展，要敢于坚持真理修正谬误" },
        { h: "走向自由，限度，条件，目标", q: "必然与自由", a: "认识和改造世界是从必然走向自由，自由有限度，不能摆脱必然性的制约。自由有条件。认识必然和争取自由是人类认识改造世界的目标" },
        // 第三章
        { h: "辩证关系，相对独立性（不平衡、内部影响、反作用）", q: "社会存在与社会意识的辩证关系", a: "社会意识和社会存在辩证统一，存在决定意识，意识反映/反作用存在\n1. 存在是客观来源，意识是物质的生活的主观反映，是具体的历史的\n2. 社会意识具有相对独立性，根本上受社会存在决定的同时有自己的发展规律：二者发展不同步不平衡；意识内部相互影响且历史继承；对社会存在具有能动的反作用（先进促进，落后阻碍）。" },
        { h: "生产力与生产关系（规律），经基与上建（规律）", q: "*社会基本矛盾及其运动规律", a: "社会基本矛盾是生产力与生产关系，经济基础与上层建筑矛盾。这两个矛盾运动规律是人类社会发展的基本规律\n1. 生产力与生产关系：生产力决定生产关系，生产力是支配地位（作为物质基础决定生产关系性质、生产力发展引起关系变化）；生产关系反作用于生产力（适合推动，不适合阻碍）。规律：二者的作用表现为矛盾运动，生产关系一定要适合生产力状况。\n2. 经济基础与上层建筑：经济基础决定上层建筑；上层建筑反作用于经济基础（确立统治地位，适合推动不适阻碍）。规律：上层建筑一定要适合经济基础状况。" },
        { h: "统一性，多样性，必然性与选择性", q: "社会形态更替的规律", a: "社会形态是社会运动的具体形式，发展阶段和不同质态。是生产力发展一定阶段相适应的经济基础和上层建筑的统一体。包括社会的经济形态，政治形态和意识形态（经济形态是基础）\n1. 统一性：五种社会形态依次更替是社会运动一般过程。\n2. 多样性：更替形式、速度、跳跃不同。\n3. 必然性与选择性：社会形态依次更替的规律客观，趋势确定（由生产力和生产关系矛盾运动决定）；但人的历史活动有能动性，遵循社会发展的基础上对某种社会形态有历史选择性" },
        { h: "基本矛盾，动力因素，其他矛盾，表现形式", q: "社会发展的根本动力", a: "社会基本矛盾（生产力和生产关系、经济基础和上层建筑的矛盾）。\n1. 生产力是基本矛盾中的基本动力因素，人类社会发展进步的决定力量，是衡量社会进步的根本尺度。\n2. 社会基本矛盾决定社会其他矛盾的存在发展\n3.社会基本矛盾从根本上促进社会形态的变化发展（以阶级斗争表现，最高形式革命）。" },
        { h: "现实性，社会关系总和，社会属性", q: "唯物史观对人的本质的理解", a: "1. 人是现实的，不是抽象的。\n2. 人的本质是一切社会关系的总和。\n3. 属性：社会属性是本质属性。" },
        { h: "史观对比，决定性作用，受制约，群众路线", q: "人民群众是历史的创造者", a: "1. 群众史观是唯物史观，人民群众是历史创造者，有主体地位\n2. 人民群众的决定性作用：是社会物质财富和精神财富创造者；是社会变革决定力量。\n3. 人民群众创造历史受历史条件（经济政治精神文化）制约。\n4. 马克思主义群众路线和党的群众路线：坚信人民群众解放自己，全心全意向人民服务，为人民负责，一切为了群众，一切依靠群众，从群众中来，到群众中去。" },
        // 第四章
        { h: "社会分工，所有权分离", q: "商品经济（以交换为目的生产）的产生条件", a: "1. 存在社会分工。\n2. 生产资料和劳动产品属于不同所有者" },
        { h: "使用价值，价值，对立统一关系", q: "*商品二因素", a: "1. 商品二因素：使用价值和价值。\n2. 使用价值：商品满足人需要的有用性，是自然属性。\n3. 价值：量化的商品中的一般劳动，本质上是生产者交换劳动，体现生产者的社会关系，是社会属性。\n4. 二者对立统一（使用价值和价值相互排斥，只有将使用价值让渡给消费者才有价值。同时具有两个因素）。" },
        { h: "具体劳动，抽象劳动，决定二因素，关系", q: "*劳动二重性", a: "1. 劳动二重性：具体劳动（创造具有使用价值的具体形式的劳动）；抽象劳动（撇开具体形式/无差别人类劳动，体力脑力耗费）。\n2. 具体劳动创造使用价值，抽象劳动形成价值。\n3. 任何生产商品的劳动既是特殊的具体劳动又是抽象劳动，劳动二重性决定商品二因素\n4. 具体劳动抽象劳动对立（反应不同属性）统一（时空间统一）" },
        { h: "决定因素，与生产率关系，复杂劳动", q: "价值量及其决定", a: "1. 由劳动者生产所耗费的劳动量决定，决定价值量的是社会必要劳动时间（正常生产条件平均熟练程度和劳动强度）。\n2. 与劳动生产率成反比（生产率高，单位商品价值量小）。\n3. 商品价值量与简单/复杂劳动有密切关系，复杂劳动（需专门培训，有一定文化知识和技术专长）创造的价值大于简单劳动（无需专门培训）。" },
        { h: "社会生产，从业人员，价值分配", q: "劳动价值论当代认识", a: "1.不止是创造剩余价值，考虑什么是社会生产\n2. 深化对科技，经营人员对作用认识\n3. 价值创造和分配关系认识" },
        { h: "本质，职能", q: "货币的起源，本质和职能", a: "1. 本质：一般等价物，体现劳动社会关系\n2. 职能：价值尺度，流通手段" },
        { h: "内容，形式，作用（积极/消极）", q: "价值规律的内容、形式及作用", a: "1. 内容：价值量由社会必要劳动时间决定，等价交换。\n2. 形式：价格围绕价值自发波动。\n3. 作用：积极（调节生产资料和劳动力分配、刺激生产力发展、调节收入分配）；消极（社会资源浪费、阻碍技术进步、收入两极分化）。" },
        { h: "两重性，矛盾内容，地位（决定本质、基础、命运）", q: "*私有制商品经济的基本矛盾", a: "1.私有制商品经济两重性：既是社会劳动（生产者劳动的社会性）又是私人劳动（生产资料私有）\n2. 私人劳动和社会劳动的矛盾是私有制商品经济的基本矛盾。该矛盾决定商品经济的本质与发展。\n3. 私人劳动通过交易转化为社会劳动，是解决矛盾的唯一途径。\n4. 私人劳动和社会劳动的矛盾是商品经济其他矛盾的基础（商品交换中能否卖出，具体劳动是否能被还原成抽象劳动，根本上取决于该矛盾的统一），决定着商品生产者的命运。" },
        { h: "现象，三个原因", q: "商品拜物教的理解", a: "商品生产者不能决定自己的命运，而是由价值，商品和货币运动的摆布，根本原因：\n1.劳动产品只有商品形式可以交换。\n2.劳动量只有价值量可以比较\n3.劳动关系只有在交易间体现社会性质" },
        { h: "条件，特点（价值/使用价值），货币转化为资本", q: "劳动力成为商品与货币转化为资本（为什么资本在流通中创造价值）", a: "1. 条件：劳动者自由，可以交易自己的劳动力且依赖这个为生。\n2. 劳动力商品特点：标志着简单商品生产到资本主义商品生产。价值（维持生存、家属生存、教育费用）由延续劳动力必须的生活必需品价值决定；使用价值是价值源泉（能创造剩余价值）。\n3. 货币通过购买劳动力剩余价值转化为资本：资本是增值价值的价值，反映剥削。" },
        { h: "定义，雇佣关系", q: "资本主义所有制", a: "生产资料归资本家所有的私有制形式，劳动者与生产资料分离，变为雇佣劳动关系" },
        { h: "二重性，资本本质，不变/可变资本，意义", q: "*剩余价值的生产过程与资本本质", a: "1. 剩余价值在资本主义二重性（生产物质资料的劳动过程和生产剩余价值的增值过程）生产过程中生产，由雇佣工人创造并被无偿占有，超过劳动力价值的部分，体现剥削关系。\n2. 资本本质：资本是能够带来剩余价值的价值，根据不同部分（可变和不可变）在剩余价值生产中的关系分为不可变资本（以生产资料形式存在，仅转移价值）和可变资本（用于购买劳动力，劳动力创造剩余价值）\n3.上述理论的意义在于 揭示剩余价值的源泉，为剥削程度提供科学依据（剩余价值率）" },
        { h: "绝对，相对，超额，关系", q: "*剩余价值生产两种基本方法：绝对剩余价值与相对剩余价值", a: "1. 绝对剩余价值：必要劳动时间不变前提下延长工作长度、提高劳动强度。\n2. 相对剩余价值：工作长度不变前提下缩短必要劳动时间，相对延长剩余劳动时间（全社会劳动生产率提高的结果）。\n3. 超额剩余价值：个别企业提高劳动生产率使商品低于社会价值获得的差额。\n4. 客观上促进了生产力的发展和社会进步\n5. 两种方法的结果和本质都是一样的，发展初期依靠绝对剩余价值来提高剥削程度，随着技术改进和工人反抗相对剩余价值作用更突出" },
        { h: "概念，根源，作用，趋势", q: "*资本积累及作用", a: "1. 概念：剩余价值资本化为资本，本质上是占用工人的剩余价值来扩大资本\n2. 根源：剩余价值。\n3. 作用：扩大再生产；财富两极分化；过剩人口失业。\n4. 历史趋势：资本主义必将灭亡社会主义必将胜利" },
        { h: "源头，掩盖剥削，利润率平均化", q: "剩余价值与利润的关系（剥削如何被资本运作的表象所掩盖的）", a: "1. 剩余价值的源头是工人的劳动（可变资本）。但资本家视为全部投入本金产出的回报，掩盖了剥削。\n2. 资本从低利润率部门流向高利润率部门，直到全社会的利润率趋于平衡" },
        { h: "三个阶段，三个职能，周转及影响因素", q: "资本循环与周转", a: "1. 循环三个阶段：购买（货币资本）、生产（生产资本）、售卖（商品资本）。\n2. 产业资本运动的条件：空间上要求三种形式并存，时间上要求三种职能在时间上连续发生。\n3. 资本周转：资本周而复始的循环。影响因素：周转时间和周期、固定/流动资本构成。" },
        { h: "定义，核心问题，条件", q: "社会总资本的再生产和流通", a: "1. 定义：连续不断的社会生产\n2. 核心问题：社会总产品（一定时期生产的全部物质资料）的实现问题：总产品的价值补偿和实物补偿问题。\n3. 顺利进行的条件：1.耗费的资本得到补偿，2.耗费的生产和消费资料得到实物替换，3.客观上：各个部门的两大门类间保持一定总量和结构上的比例 " },
        { h: "定义，表现形式", q: "工资的本质", a: "定义：工人的工资是劳动力而非劳动的价值，以货币支付，模糊了必要劳动和剩余价值" },
        { h: "本质，根本原因，周期性", q: "资本主义基本矛盾与经济危机", a: "1. 经济危机本质：相对需求的生产相对过剩。\n2. 根本原因：资本主义基本矛盾（生产社会化与生产资料私人占有），体现在生产的无限扩大和劳动人民有支付能力的需求相对缩小，单个企业内部有组织和社会无政府。\n3. 周期性：危机、萧条、复苏、高涨。" },
        // 第五章
        { h: "规律，原因，途径", q: "垄断的形成与垄断组织", a: "垄断资本主义在生产和资本集中的基础上形成。（垄断是少数大企业为利润而联合，对几个部门商品的生产销售和价格进行操控）\n1. 规律：自由竞争引起生产集中，集中发展到一定阶段产生垄断。\n2. 原因：获得高额利润；规模巨大限制竞争；联合避免竞争而两败俱伤。\n3. 途径：通过组织联合" },
        { h: "关系，新特点", q: "垄断条件下的竞争", a: "垄断使竞争更复杂和激烈\n1. 垄断不能消除竞争（并存）。\n2. 特点：目的是高额垄断利润；手段包括经济和非经济手段，更激烈；范围是国际。" },
        { h: "金融资本，金融寡头", q: "金融资本和金融寡头", a: "金融资本：工业垄断资本和银行资本金融上融合\n金融寡头：金融资本形成的基础上产生，是垄断资本主义国家的实际控制者" },
        { h: "垄断利润（来源），垄断价格（形式/结果）", q: "垄断利润与垄断价格", a: "垄断资本的实质在于获得垄断利润（垄断资本家凭借在生产流通中的垄断地位获得的远超市场平均的超额利润）1. 垄断利润来源：本质剩余价值，具体是工人剩余价值、非垄断企业利润、国外掠夺、再分配。\n2. 通过垄断价格实现：垄断高价和垄断低价。结果：抑制市场价自由波动，是价值规律在资本主义阶段作用的体现" },
        { h: "本质，原因，形式，作用", q: "国家垄断资本主义", a: "1. 本质：国家政权与私人垄断资本融合。\n2. 原因：科技进步，社会化程度提高。\n3. 形式：国企、合营、采购/津贴、宏观调节、微观规制。\n4. 作用：一定程度促进生产力，但没有改变资本主义本质，加强了对人民的剥削，更好的保证了垄断利润，有利于维护资本主义制度，但没有根本上消除基本矛盾。" },
        { h: "金融化，世界扩张（动力/形式/后果）", q: "金融垄断资本的发展和世界范围扩张", a: "1. 金融自由化和创新提供制度条件，表现为资本主义经济金融化程度提高，金融垄断资本的控制能力增强。促进资本主义经济发展也导致经济虚拟化。\n2. 世界范围扩张：以追逐高额垄断利润为根本动力，依托跨国公司和国家资本输出，表现为借贷、生产及商品资本在全球范围的流动与扩张。这在促进全球资源配置和加强资本主义世界体系联系的同时，也导致发展中国家经济命脉受控、输出国产业空心化以及全球经济动荡风险的加剧。\n3. 国家垄断资本主义的实质是垄断资本通过垄断地位获得高额利润" },
        { h: "实质，表现，原因，影响", q: "经济全球化", a: "1. 实质：生产力发展和社会化大生产的要求。\n2. 表现：生产、贸易、金融全球化。\n3. 原因:科学技术进步与生产力发展，跨国公司的发展，各国经济体制变革和国际经济组织发展。\n4. 影响：资源配置优化，但发达国家和发展中国家地位收益不平等。" },
        { h: "实质（自我调节），新特征", q: "当代资本主义新变化", a: "当代资本主义的变化是其为适应科技与生产力发展而进行的自我调节，具体呈现为生产方式革新、国际金融垄断深化、社会阶级结构复杂化以及推行霸权主义等新特征。这些变化仅局限于资本主义制度框架内，既未改变其生产关系的根本性质，也无法彻底克服其固有的基本矛盾。" }
    ];

    // ==========================================
    // 数据源 2: 新增的名词解释 (Noun)
    // ==========================================
    const nounData = [
        { q: "物质", a: "物质是标志客观实在的哲学范畴，是不依赖人的意识而存在，并能为人的意识所反映的客观实在。物质具有客观实在性" },
        { q: "运动", a: "运动是标志一切事物和现象的变化及其过程的哲学范畴" },
        { q: "实践", a: "实践是人类能动地改造世界的社会性的物质活动" },
        { q: "联系", a: "联系是指事物之间和实物内部各要素之间相互影响，制约，作用的过程" },
        { q: "发展", a: "发展是事物变化中前进的，上升的运动" },
        { q: "矛盾", a: "矛盾是反映事物内部和事物之间对立统一关系的哲学范畴。\n主要矛盾：矛盾体系中处于支配地位，对食物发展起决定作用的矛盾。\n次要矛盾：矛盾体系中处于从属地位，对事物发展起次要作用的矛盾" },
        { q: "辩证法", a: "唯物辩证法包括主观辩证法和客观辩证法，是二者的有机统一。\n客观辩证法：客观事物客观存在的辩证法，即客观事物相互作用，相互联系的形式展现出的各种物质形态的辩证运动和发展规律。\n主观辩证法：人类思维和认识运动中的辩证法，即以概念作为思维细胞的辩证思维运动和发展规律" },
        { q: "认识", a: "认识是主体在实践基础上对客体的能动反映，具有反映客体内容的反应性特征以及实践要求的能动的，创造性特征。\n认识运动的基本规律：从实践到认识，再从认识到实践的过程" },
        { q: "真理", a: "真理是标志主观与客观相符合的哲学范畴，是对客观事物的正确反映" },
        { q: "谬误", a: "谬误是同客观事物及其发展规律相违背的认识，是对客观事物及其发展规律的歪曲反映。\n（认识的发展与真理的获得，是在对谬误的不断更正中实现的）" },
        { q: "自由与必然", a: "自由是标示人的活动状态的范畴，是指人在活动中通过认识和利用必然所表现出的自由自主的状态。\n必然性即规律性，指的是不依赖人的意识而存在的自然和社会发展所固有的客观规律。" },
        { q: "社会存在与社会意识（考过）", a: "社会存在决定社会意识\n社会意识具有相对独立性，社会意识从根本上受到社会存在决定的同时，还具有独特的发展形势与规律" },
        { q: "人类社会基本矛盾与社会发展基本规律", a: "人类社会基本矛盾：生产力与生产关系之间的矛盾，经济建筑与上层建筑之间的矛盾。\n社会发展基本规律：生产力与生产关系之间的矛盾运动的规律，经济建筑与上层建筑之间的矛盾运动的规律" },
        { q: "社会形态", a: "社会形态是关于社会运动的具体形式，发展阶段和不同质态的范畴，是同生产力发展一定阶段相适应的经济建筑和上层建筑的统一体，包括社会运动的经济，政治，意识形态" },
        { q: "现实的人与人的本质", a: "人不是抽象是具体的，社会历史存在和发展的前提是现实的人及其活动。\n人的本质是不是单个人所固有的抽象物 在现实性上，它是一切社会关系的总和" },
        { q: "英雄史观与群众史观", a: "英雄史观：从社会意识决定社会存在的基本前提出发，否认物质资料生产方式对社会发展的决定作用，抹杀人民群众的历史作用，宣扬少数英雄人物创造历史。\n群众史观：认为人民群众是历史的创造者，这体现了唯物史观在考察历史创造者问题上的方法论" },
        { q: "马克思主义群众观点与党的群众路线", a: "马克思主义群众观点：\n坚信人民群众自己解放自己的观点\n全心全意为人民服务的观点\n一切向人民群众负责的观点\n虚心向人民群众学习的观点。\n\n党的群众路线：一切为了群众，一切依靠群众，从群众中来，到群众中去。" },
        { q: "商品经济", a: "商品经济：是以交换为目的的经济形式，存在社会分工，生产资料和劳动产品属于不同所有者" },
        { q: "价值与使用价值", a: "1. 使用价值\n定义：指商品能满足人们某种需要的有用性。\n属性：是商品的自然属性，是一切劳动产品所共有的属性，构成社会财富的物质内容。\n2. 价值\n定义：凝结在商品中的无差别的一般人类劳动，即人的脑力和体力的耗费。\n属性：是商品特有的社会属性。" },
        { q: "具体劳动，抽象劳动，简单劳动，复杂劳动", a: "1. 具体劳动\n是生产一定使用价值的具体形式的劳动，反映的是人与自然的关系，属于劳动的自然属性。\n2. 抽象劳动\n是撇开一切具体形式的、无差别的一般人类劳动，即人的体力和脑力的耗费，反映的是商品生产者的社会关系，属于劳动的社会属性。\n3. 简单劳动：不需要经过专门训练和培养，一般劳动者都能从事的劳动。\n4. 复杂劳动：需要经过专门训练和培养，具有一定文化知识和技术专长的劳动者所从事的劳动。" },
        { q: "社会必要劳动时间", a: "在现有社会正常的生产条件下，在社会平均熟练度和劳动强度下创造某种使用价值所需要的劳动时间" },
        { q: "货币", a: "长期交换中形成的固定充当一般等价物的商品" },
        { q: "社会劳动与私人劳动／私有制商品经济的基本矛盾（考过）", a: "1. 社会劳动\n商品生产者的劳动的社会性质由社会分工决定，每个商品生产者的劳动都是社会总劳动的一部分，因此具有社会性质。\n2. 私人劳动\n商品生产者的劳动的私人性质由生产资料私有制决定，在私有制条件下，商品生产者的劳动按自身利益和要求进行，因此具有私人性质。\n私人劳动和社会劳动的矛盾构成私有制商品经济的基本矛盾" },
        { q: "资本原始积累", a: "以暴力手段将生产者和生产资料分离，资本迅速集中于少数人手中，资本主义得以迅速发展的历史进程" },
        { q: "资本", a: "资本是增值价值的价值，反映资本家与工人剥削与被剥削的关系" },
        { q: "资本主义所有制", a: "生产资料归资本家所有的一种所有制形式" },
        { q: "剩余价值", a: "剩余价值是由工人创造出的，并被资本家无偿占有的，超过劳动力价值的那部分价值。" },
        { q: "绝对剩余价值和相对剩余价值", a: "1. 绝对剩余价值生产\n- 前提：必要劳动时间不变。\n- 手段：通过延长工作日的长度或提高劳动强度来增加剩余价值\n\n2. 相对剩余价值生产\n- 前提：工作日长度不变。\n- 手段：通过缩短必要劳动时间，从而相对延长剩余劳动时间来生产剩余价值" },
        { q: "资本积累", a: "把剩余价值转化为资本，就是资本积累" },
        { q: "资本循环与资本周转", a: "资本循环：资本从一种形式出发，经过一系列变化，又回到出发点的运动。\n资本循环：周而复始，不断重复的资本循环，称为资本周转" },
        { q: "社会再生产与社会总产品", a: "社会再生产：连续不断的社会生产\n社会总产品：社会在一定时期（通常为一年）内产生的所有物质资料之和" },
        { q: "资本主义工资", a: "工人的工资是劳动力的价值" },
        { q: "资本主义的基本矛盾（考过）", a: "生产社会化与生产资料资本主义私人占有之间的矛盾" },
        { q: "垄断（考过）", a: "少数资本主义大企业为了获得高额利润，通过相互协议或联合，对一个或几个部门商品的生产销售和价格进行操纵和控制" },
        { q: "金融资本与金融寡头", a: "金融资本：工业垄断资本与银行资本融合在一起形成的垄断资本。\n金融寡头：金融资本的基础上产生。操纵国民经济命脉并实际上控制国家政权的少数垄断资本主义企业家和集团，是垄断资本主义国家实际上的统治者。" },
        { q: "国家垄断资本主义", a: "国家垄断资本主义是国家政权和私人垄断资本融合在一起的垄断资本主义。" },
        { q: "经济全球化", a: "经济全球化是指在生产不断发展、科技加速进步、社会分工和国际分工不断深化、生产的社会化和国际化程度不断提高的情况下，世界各国、各地区经济活动越来越超出某一国家和地区范围而相互联系、相互依存的过程。" }
    ];

    // 全局状态
    let questions = []; 
    let currentMode = 'seq';
    let currentIndex = 0;
    let errorList = []; 
    let shuffledIndices = [];
    let currentDataSetName = 'principle'; // 'principle' 或 'noun'

    // 初始化
    function init() {
        loadDataSet('principle');
        updateUI();
    }

    // 切换数据源逻辑
    function loadDataSet(dataSetName) {
        currentDataSetName = dataSetName;
        let sourceData = (dataSetName === 'noun') ? nounData : principleData;
        
        // 重置状态
        questions = sourceData.map((item, index) => ({ id: index, ...item }));
        errorList = [];
        shuffledIndices = [];
        currentIndex = 0;
        
        // 更新界面文字
        const text = (dataSetName === 'noun') ? '名词解释' : '简答题';
        document.getElementById('data-source-text').innerText = `当前题库: ${text}`;
        
        // 如果是在随机模式下切换，需要重新洗牌
        if (currentMode === 'rand') {
            shuffledIndices = questions.map(q => q.id).sort(() => Math.random() - 0.5);
        }
    }

    function switchMode(mode) {
        // --- 核心修复逻辑：点击名词解释模式 ---
        if (mode === 'noun') {
            if (currentDataSetName !== 'noun') {
                loadDataSet('noun');
            }
            // 内部逻辑视为顺序，但 UI 上我们保持 Noun 按钮高亮
        } 
        // --- 核心修复逻辑：点击顺序/随机模式 ---
        else if (mode === 'seq' || mode === 'rand') {
            // 只有当当前是名词题库时，才切换回简答题库
            if (currentDataSetName === 'noun') {
                loadDataSet('principle');
            }
        }

        // 统一设置当前模式状态
        // 注意：名词模式在逻辑上我们也标记为 'noun'，但在获取题目索引时，我们让它走 default (seq) 的逻辑
        currentMode = mode;
        
        // 样式更新
        document.querySelectorAll('.mode-group button').forEach(btn => btn.classList.remove('active'));
        
        if (mode === 'list') {
            document.getElementById('mode-list').classList.add('active');
        } else if (mode === 'noun') {
            document.getElementById('mode-noun').classList.add('active');
        } else {
            // 高亮 seq, rand, err
            document.getElementById(`mode-${mode}`).classList.add('active');
        }

        const quizArea = document.getElementById('quiz-area');
        const listArea = document.getElementById('list-view');
        const navControls = document.getElementById('nav-controls');

        if (mode === 'list') {
            quizArea.style.display = 'none';
            listArea.style.display = 'block';
            navControls.style.visibility = 'hidden'; 
            renderList(); 
            
            setTimeout(() => {
                const currentRealIndex = getCurrentIndexValue();
                const targetId = `list-item-${currentRealIndex}`;
                const el = document.getElementById(targetId);
                if (el) {
                    el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    document.querySelectorAll('.list-item').forEach(i => i.classList.remove('active-item'));
                    el.classList.add('active-item');
                }
            }, 100);

        } else {
            quizArea.style.display = 'flex';
            listArea.style.display = 'none';
            navControls.style.visibility = 'visible';

            if (mode === 'rand') {
                // 如果是新切入随机模式（且不在名词模式下，因为名词模式没随机按钮逻辑），洗牌
                if (shuffledIndices.length === 0 || shuffledIndices.length !== questions.length) {
                     shuffledIndices = questions.map(q => q.id).sort(() => Math.random() - 0.5);
                }
            } else if (mode === 'err') {
                if (errorList.length === 0) {
                    alert("当前题库错题本为空！");
                    // 回退到该题库的默认模式
                    switchMode(currentDataSetName === 'noun' ? 'noun' : 'seq'); 
                    return;
                }
                currentIndex = 0;
            } 
            
            loadQuestion();
        }
    }

    function getCurrentIndexValue() {
        if (currentMode === 'rand') return shuffledIndices[currentIndex % questions.length];
        if (currentMode === 'err') return errorList[currentIndex % errorList.length];
        // mode 'seq' 和 'noun' 都走这里
        return currentIndex % questions.length; 
    }

    function getCurrentQuestion() {
        const idx = getCurrentIndexValue();
        return questions[idx];
    }

    function loadQuestion() {
        resetInputArea();
        const q = getCurrentQuestion();
        
        const displayIndex = (currentMode === 'err') ? (currentIndex % errorList.length + 1) : (currentIndex % questions.length + 1);
        const total = (currentMode === 'err') ? errorList.length : questions.length;
        
        document.getElementById('question-text').innerText = `[${currentMode === 'err' ? '错题' : displayIndex}] ${q.q}`;
        document.getElementById('jump-index').value = displayIndex; 
        
        // 重置提示区域
        const hintEl = document.getElementById('hint-display');
        hintEl.style.display = 'none';
        hintEl.innerHTML = '';
        
        updateStats(displayIndex, total);
    }

    function toggleHint() {
        const hintEl = document.getElementById('hint-display');
        const q = getCurrentQuestion();
        
        if (hintEl.style.display === 'none' || hintEl.style.display === '') {
            const hintContent = q.h ? q.h : "本题为名词解释，请直接背诵定义。";
            hintEl.innerHTML = `<strong>💡 提示关键词：</strong>${hintContent}`;
            hintEl.style.display = 'block';
        } else {
            hintEl.style.display = 'none';
        }
    }

    function renderList() {
        const container = document.getElementById('list-view');
        let html = '';
        questions.forEach((item, index) => {
            html += `
                <div class="list-item" id="list-item-${index}" onclick="jumpFromList(${index})">
                    <div class="list-q">${item.q}</div>
                    <div class="list-a">${item.a}</div>
                </div>
            `;
        });
        container.innerHTML = html;
    }

    function jumpFromList(realIndex) {
        // 保持当前题库模式（名词或简答），切回主视图
        // 如果是名词库，保持 noun 模式；如果是简答库，保持 seq 模式
        const targetMode = (currentDataSetName === 'noun') ? 'noun' : 'seq';
        currentMode = targetMode;
        currentIndex = realIndex;
        
        document.getElementById('quiz-area').style.display = 'flex';
        document.getElementById('list-view').style.display = 'none';
        document.getElementById('nav-controls').style.visibility = 'visible';
        
        // 恢复按钮高亮
        document.querySelectorAll('.mode-group button').forEach(btn => btn.classList.remove('active'));
        if (targetMode === 'noun') document.getElementById('mode-noun').classList.add('active');
        else document.getElementById('mode-seq').classList.add('active');

        loadQuestion();
    }

    function handleJumpEnter(e) {
        if (e.key === 'Enter') jumpToQuestion();
    }

    function jumpToQuestion() {
        const input = document.getElementById('jump-index');
        let val = parseInt(input.value);
        let total = currentMode === 'err' ? errorList.length : questions.length;

        if (isNaN(val) || val < 1 || val > total) {
            alert(`请输入 1 - ${total} 之间的数字`);
            return;
        }
        
        currentIndex = val - 1; 
        loadQuestion();
    }

    function changeQuestion(delta) {
        let total = currentMode === 'err' ? errorList.length : questions.length;
        currentIndex += delta;
        
        if (currentIndex < 0) currentIndex = total - 1;
        if (currentIndex >= total) currentIndex = 0;
        
        loadQuestion();
    }

    function resetInputArea() {
        document.getElementById('result-area').style.display = 'none';
        document.getElementById('btn-submit').style.display = 'inline-block';
        document.getElementById('user-input').value = '';
        document.getElementById('user-input').disabled = false;
        document.getElementById('btn-submit').innerText = "提交验证";
        document.getElementById('btn-submit').disabled = false;
        document.getElementById('btn-submit').style.backgroundColor = 'var(--success-color)';
    }

    function updateStats(current, total) {
        document.getElementById('progress-text').innerText = `进度: ${current} / ${total}`;
        document.getElementById('error-count').innerText = `错题本: ${errorList.length}`;
    }

    function renderDiff(userStr, stdStr) {
        let tempUser = userStr.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g, "");
        let html = '';
        for (let char of stdStr) {
            if (/[\u4e00-\u9fa5a-zA-Z0-9]/.test(char)) {
                if (tempUser.includes(char)) {
                    html += `<span style="color: var(--success-color); font-weight:bold;">${char}</span>`;
                    tempUser = tempUser.replace(char, ''); 
                } else {
                    html += `<span style="color: var(--error-color); opacity: 0.6;">${char}</span>`;
                }
            } else {
                html += char;
            }
        }
        return html;
    }

    function calculateSimilarity(str1, str2) {
        const clean1 = str1.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g, "");
        const clean2 = str2.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g, "");
        if (clean2.length === 0) return 0;
        
        let matchCount = 0;
        let tempStr1 = clean1;
        for (let char of clean2) {
            if (tempStr1.includes(char)) {
                matchCount++;
                tempStr1 = tempStr1.replace(char, ''); 
            }
        }
        const maxLength = Math.max(clean1.length, clean2.length);
        if (maxLength === 0) return 0;
        return Math.floor((matchCount / maxLength) * 100);
    }

    function checkAnswer() {
        const userVal = document.getElementById('user-input').value;
        const currentQ = getCurrentQuestion();
        
        if (!userVal.trim()) {
            alert("请先输入答案");
            return;
        }

        const score = calculateSimilarity(userVal, currentQ.a);
        const passed = score >= 70;

        if (!passed) {
            if (!errorList.includes(currentQ.id)) errorList.push(currentQ.id);
        }

        const resultHeader = document.getElementById('result-header');
        const badgeClass = passed ? 'badge-pass' : 'badge-fail';
        const badgeText = passed ? '通过' : '未通过';
        
        resultHeader.innerHTML = `
            <span class="score-badge ${badgeClass}">${badgeText}</span>
            <span>得分: ${score}</span>
        `;
        
        document.getElementById('score-text').innerText = `准确率: ${score}%`;
        
        const coloredHtml = renderDiff(userVal, currentQ.a);
        document.getElementById('standard-answer').innerHTML = coloredHtml.replace(/\n/g, '<br>');
        
        document.getElementById('result-area').style.display = 'block';

        const submitBtn = document.getElementById('btn-submit');
        submitBtn.innerText = passed ? "回答正确" : "回答错误";
        submitBtn.disabled = true;
        submitBtn.style.backgroundColor = passed ? '#95a5a6' : '#95a5a6';
        
        updateStats((currentMode === 'err' ? currentIndex % errorList.length + 1 : currentIndex % questions.length + 1), 
                    (currentMode === 'err' ? errorList.length : questions.length));
    }

    function updateUI() {
        switchMode('seq');
    }

    init();

</script>

</body>
</html>